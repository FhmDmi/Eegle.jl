<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial SA 2 ¬∑ Eegle</title><meta name="title" content="Tutorial SA 2 ¬∑ Eegle"/><meta property="og:title" content="Tutorial SA 2 ¬∑ Eegle"/><meta property="twitter:title" content="Tutorial SA 2 ¬∑ Eegle"/><meta name="description" content="Documentation for Eegle."/><meta property="og:description" content="Documentation for Eegle."/><meta property="twitter:description" content="Documentation for Eegle."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Eegle logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Eegle</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Eegle Documentation</a></li><li><a class="tocitem" href="../../Eegle/">Eegle Package</a></li><li><a class="tocitem" href="../">Tutorials</a></li><li><span class="tocitem">Eegle Modules</span><ul><li><a class="tocitem" href="../../Preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Processing/">Processing</a></li><li><a class="tocitem" href="../../ERPs/">Event-Related Potentials</a></li><li><a class="tocitem" href="../../BCI/">Brain-Computer Interface</a></li><li><a class="tocitem" href="../../Database/">Database</a></li></ul></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../../InOut/">Input/Output</a></li><li><a class="tocitem" href="../../FileSystem/">File System</a></li><li><a class="tocitem" href="../../Miscellaneous/">Miscellaneous</a></li></ul></li><li><span class="tocitem">Data</span><ul><li><a class="tocitem" href="../../documents/Example Data/">Example Data</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">BCI DBs Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../documents/BCI Databases Overview/">BCI DBs Overview</a></li><li><a class="tocitem" href="../../documents/Databases Summary MI/">databases Summary MI</a></li><li><a class="tocitem" href="../../documents/TreatmentMI/">TreatmentMI</a></li><li><a class="tocitem" href="../../documents/Databases Summary P300/">databases Summary P300</a></li><li><a class="tocitem" href="../../documents/TreatmentP300/">TreatmentP300</a></li><li><a class="tocitem" href="../../documents/yamlstruct/">NY metadata (YAML)</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial SA 2</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial SA 2</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/Eegle.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Marco-Congedo/Eegle.jl/blob/master/docs/src/Tutorials/Tutorial Spectral Analysis 2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-SA-2"><a class="docs-heading-anchor" href="#Tutorial-SA-2">Tutorial SA 2</a><a id="Tutorial-SA-2-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-SA-2" title="Permalink"></a></h1><p>Sometimes the <em>power spectral density</em> is to be estimated on specific epochs (e.g., experimental trials).</p><p>This tutorial uses the <a href="../../documents/Example Data/#EXAMPLE_MI_1"><code>EXAMPLE_MI_1</code></a> Motor Imagery (MI) Brain-Computer Interface EEG file provided with <strong>Eegle</strong> and shows how to</p><ol><li>read the MI example file (in <a href="../../documents/BCI Databases Overview/#NY-format">NY format</a>)</li><li>compute and average the spectra across trials for all MI classes</li><li>plot the spectra.</li></ol><div class="admonition is-info" id="Info-242cb3a532f4c0ea"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-242cb3a532f4c0ea" title="Permalink"></a></header><div class="admonition-body"><p>For all options in computing spectra see the  <a href="https://marco-congedo.github.io/FourierAnalysis.jl/dev/spectra/#FourierAnalysis.spectra">spectra</a> function. </p></div></div><hr/><p>Tell julia the package to be used</p><pre><code class="language-julia hljs">    using Eegle, FourierAnalysis, CairoMakie</code></pre><p>Load the example MI file by means of the <code>readNY</code> function of the <strong>Eegle</strong> <a href="../../InOut/#InOut.jl">InOut.jl</a> module.</p><pre><code class="language-julia hljs">o = Eegle.readNY(EXAMPLE_MI_1)</code></pre><p>Variable <code>o</code> holds an <a href="../../InOut/#Eegle.InOut.EEG"><code>EEG</code></a> structure with the data (<code>o.X</code>) and metadata, such as</p><ul><li>sampling rate: <code>o.sr</code>,</li><li>trial duration: <code>o.wl</code>,</li><li>sensor labels: <code>o.sensors</code>,</li><li>class labels: <code>o.clabels</code>.</li></ul><p>The file comprises trials from three classes, as it follows:</p><table><tr><th style="text-align: left">Class Tag</th><th style="text-align: left">Class Label</th><th style="text-align: left">Number of Trials</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">right_hand</td><td style="text-align: left">20</td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">feet</td><td style="text-align: left">20</td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">rest</td><td style="text-align: left">20</td></tr></table><p>Next, create an utility function to extract the EEG data of the trials for a given <code>sensor</code>, for each class separately. For this, use the <code>trials</code> function of the <a href="../../ERPs/#ERPs.jl">ERPs.jl</a> module.</p><p>A call to the following function will therefore generate a vector of three elements, one for each class, each one holding 20 vectors, one for each trial, each one holding the trial data at the sought electrode (<code>e</code>). </p><pre><code class="language-julia hljs">t(eeg, sensor) = trials(eeg.X, eeg.mark, eeg.wl; 
                        shape=:byClass, 
                        linComb=findfirst(==(sensor), eeg.sensors))</code></pre><p>Compute power spectra for sensor &quot;C3&quot; and &quot;Cz&quot; at all trials and classes using:</p><ul><li>1 Hz frequency resolution (the window length <code>wl</code> is set equal to the sampling rate)</li><li>the Welch method (93.75% overlapping sliding <code>wl</code>-long windows)</li><li>the default Harris4 tapering window.</li></ul><pre><code class="language-julia hljs">wl = o.sr
C3S = [spectra(c, o.sr, wl; slide=o.sr√∑16) for c ‚àà t(o, &quot;C3&quot;)]
CzS = [spectra(c, o.sr, wl, slide=o.sr√∑16) for c ‚àà t(o, &quot;Cz&quot;)]</code></pre><p>Now, compute the mean power spectra across trials, separately for each class, only from 1Hz to 36Hz. The bins in the spectra corresponding to these limits are found with the help of function <code>f2b</code> in package <strong>FourierAnalysis.jl</strong>.</p><pre><code class="language-julia hljs">minb = f2b(1, o.sr, wl)
maxb = f2b(36, o.sr, wl)
C3s = [mean(ùë†.y[minb:maxb] for ùë† ‚àà s) for s ‚àà C3S] 
Czs = [mean(ùë†.y[minb:maxb] for ùë† ‚àà s) for s ‚àà CzS] </code></pre><p>Plot the average power spectra in the three class for electrode &quot;C3&quot; and &quot;Cz&quot; separately.</p><pre><code class="language-julia hljs">begin
    fig=Figure(size=(600, 600))
    
    xt = Base.OneTo(maxb)
    m = maximum
    hiy = map(x-&gt;x+x*0.05, max(m(m.(C3s)), m(m.(Czs))))

    ax1 = Axis(fig[1, 1]; 
                title = &quot;C3&quot;, 
                limits=(nothing, (0, hiy)),
                ylabel =  L&quot;\mu V^2&quot;)
    for i=1:3
        lines!(ax1, xt, C3s[i], label = o.clabels[i])
    end
    axislegend(ax1)
    
    ax2 = Axis(fig[2, 1];
            title = &quot;Cz&quot;, 
            limits=(nothing, (0, hiy)),
            xlabel = &quot;Frequency&quot;,
            ylabel =  L&quot;\mu V^2&quot;)
    for i=1:3
        lines!(ax2, xt, Czs[i], label = o.clabels[i])
    end
    
    fig
end

# save the figure at 300 pixels per inch
save(&quot;spectra.png&quot;, fig, px_per_unit = 300/96)</code></pre><p><img src="../../assets/Fig1_Tutorial_Spectral_Analysis_2.jpg" alt="Figure 1"/></p><p>The expected ERD (Event-Related Desynchronization) related to right-hand movement imaging is expected to be better visible at electrode &quot;C3&quot;, which is located near the contralateral sensorimotor cortex. The effect of the ERDs is seen as a lower power during &quot;right hand&#39; trials as compared to &quot;rest&quot; trials.</p><p>Similarly, the expected effect of the &quot;feet&quot; ERD is seen at midline electrode &quot;Cz&quot;, which is the closest to the foot area of the sensorimotor cortex.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Wednesday 19 November 2025 14:30">Wednesday 19 November 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
