<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial SA 1 · Eegle</title><meta name="title" content="Tutorial SA 1 · Eegle"/><meta property="og:title" content="Tutorial SA 1 · Eegle"/><meta property="twitter:title" content="Tutorial SA 1 · Eegle"/><meta name="description" content="Documentation for Eegle."/><meta property="og:description" content="Documentation for Eegle."/><meta property="twitter:description" content="Documentation for Eegle."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Eegle logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Eegle</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Eegle Documentation</a></li><li><a class="tocitem" href="../../Eegle/">Eegle Package</a></li><li><a class="tocitem" href="../../Tutorials/">Tutorials</a></li><li><span class="tocitem">Eegle Modules</span><ul><li><a class="tocitem" href="../../Preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../../Processing/">Processing</a></li><li><a class="tocitem" href="../../ERPs/">Event-Related Potentials</a></li><li><a class="tocitem" href="../../BCI/">Brain-Computer Interface</a></li><li><a class="tocitem" href="../../Database/">Database</a></li></ul></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../../InOut/">Input/Output</a></li><li><a class="tocitem" href="../../FileSystem/">File System</a></li><li><a class="tocitem" href="../../Miscellaneous/">Miscellaneous</a></li></ul></li><li><span class="tocitem">Data</span><ul><li><a class="tocitem" href="../../documents/Example Data/">Example Data</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">BCI DBs Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../documents/BCI Databases Overview/">BCI DBs Overview</a></li><li><a class="tocitem" href="../../documents/Databases Summary MI/">databases Summary MI</a></li><li><a class="tocitem" href="../../documents/TreatmentMI/">TreatmentMI</a></li><li><a class="tocitem" href="../../documents/Databases Summary P300/">databases Summary P300</a></li><li><a class="tocitem" href="../../documents/TreatmentP300/">TreatmentP300</a></li><li><a class="tocitem" href="../../documents/yamlstruct/">NY metadata (YAML)</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial SA 1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial SA 1</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="..." title="View the repository"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-SA-1"><a class="docs-heading-anchor" href="#Tutorial-SA-1">Tutorial SA 1</a><a id="Tutorial-SA-1-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-SA-1" title="Permalink"></a></h1><p>A standard task in the analysis of continuous EEG recording is to estimate the <em>power spectral density</em>.</p><p>This tutorial uses the <a href="../../documents/Example Data/#EXAMPLE_Normative_1"><code>EXAMPLE_Normative_1</code></a> example normative EEG file provided with <strong>Eegle</strong> and shows how to</p><ol><li>read the example file (in ASCII text format) and associated file of sensor labels</li><li>compute the spectra with the <a href="https://en.wikipedia.org/wiki/Welch%27s_method">Welch method</a></li><li>plot the spectra</li></ol><div class="admonition is-info" id="Info-eac8875019a3b34d"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-eac8875019a3b34d" title="Permalink"></a></header><div class="admonition-body"><p>As an example of possible options for computing spectra, it is shown how to use the <a href="https://en.wikipedia.org/wiki/Hann_function">Hann</a> tapering window or the <a href="https://en.wikipedia.org/wiki/Slepian_function">Slepian</a> multi-taper window. For other options see the  <a href="https://marco-congedo.github.io/FourierAnalysis.jl/dev/spectra/#FourierAnalysis.spectra">spectra</a> function. </p></div></div><hr/><p>Tell julia the package to be used</p><pre><code class="language-julia hljs">    using Eegle, FourierAnalysis, GLMakie, Colors</code></pre><p>Load the example file and the associated sensor labels file.</p><p>This is a 80s recording on a 20yo woman with</p><ul><li>sampling rate : 128 </li><li>number of electrodes: 19</li><li>high-pass filter: 1.5 Hz. </li></ul><p>The following functions are in <strong>Eegle</strong> module <a href="../../InOut/#InOut.jl">InOut.jl</a>.</p><pre><code class="language-julia hljs">    X = readASCII(EXAMPLE_Normative_1)

    sensors = readSensors(EXAMPLE_Normative_1_sensors)</code></pre><p>Compute amplitude spectra (square root of the power spectra) using;</p><ul><li>the Welch method (50% overlapping sliding window, which is the default), </li><li>0.5 Hz frequency resolution (<code>fr</code>)</li><li>Hann tapering windows.</li></ul><pre><code class="language-julia hljs">    sr, fr, ne = 128, 2, length(sensors)

    S = spectra(X, sr, sr*fr; 
                tapering = FourierAnalysis.hann,
                func = √) # any function can be used here</code></pre><p>Select the spectra from 1.5 (<code>minf</code>) to 32 Hz (<code>maxf</code>). The function <code>f2b</code> finds the bin in the spectra corresponding to <code>minf</code> and <code>maxf</code>. The data is retrieved as the .y field of <a href="https://marco-congedo.github.io/FourierAnalysis.jl/dev/spectra/#Spectra">Spectra</a> object <code>S</code>.</p><pre><code class="language-julia hljs">    minf, maxf = 1.5, 32
    minb = f2b(minf, sr, sr*fr)
    maxb = f2b(maxf, sr, sr*fr)
    S_ = S.y[minb:maxb, :]</code></pre><p>Plot the spectra using GLMakie.jl. The figure will open in a new window. It is resizable and can be inspected, by zooming and panning (right mouse click). Use CTRL+click to reset the plot. Click on a legend element to toggle its visibility.</p><pre><code class="language-julia hljs">    begin  
        fig=Figure(size=(700, 400))
        
        xt = collect(ceil(Int, minf):1:maxf) # x-ticks

        hiy = map(x-&gt;x+x*0.05, maximum(S_)) # max y-axis

        # Use `ne` maximally distinguishable colors.
        c = Colors.distinguishable_colors(ne, 
                        [RGB(1,1,1), RGB(0,0,0)], 
                        dropseed=true)

        # Utility to draw thicker spectra for midline electrodes 
        mylinewidth(s) = s ∈ [&quot;FZ&quot;, &quot;CZ&quot;, &quot;PZ&quot;] ? 3 : 1.6

        ax1 = Axis(fig[1, 1]; 
                title = &quot;Amplitude Spectra&quot;, 
                limits = (nothing, (0, hiy)),
                xticks = (xt, string.(xt)),
                xlabel = &quot;Amplitude&quot;,
                ylabel =  L&quot;\mu V&quot;)

        for i = 1:ne
            lines!(ax1, S.flabels[minb:maxb], S_[:, i]; 
                    label = sensors[i], 
                    joinstyle = :round,
                    linecap = :round,
                    alpha = 0.618034,
                    linewidth = mylinewidth(sensors[i]),
                    color = c[i])
        end
        axislegend(ax1; 
                    labelsize = 12, 
                    rowgap = 0, 
                    colgap = 5,
                    nbanks = 2)
        fig
    end

    # save the figure at 300 pixels per inch
    save(&quot;spectra.png&quot;, fig; px_per_unit = 300/96)</code></pre><p><img src="../../assets/Fig1_Tutorial_Spectral_Analysis_1.jpg" alt="Figure 1"/></p><p>For using Slepian multi-tapering instead:</p><pre><code class="language-julia hljs">    S = spectra(X, sr, sr*fr; 
                tapering = slepians(sr, sr*fr, 1.5),
                func = √)</code></pre><p><img src="../../assets/Fig1_Tutorial_Spectral_Analysis_2.jpg" alt="Figure 2"/></p><p>Note that the spectra obtained using the Slepian windows are smoother and have larger lobes, due to the fact that they reduce the variance of the estimator at the expenses of the main lobe  band-width.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 27 September 2025 22:13">Saturday 27 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
